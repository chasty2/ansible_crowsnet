---
# vars file for proxmox role
proxmox_packages:
  - nfs-kernel-server

proxmox_services:
  - nfs-kernel-server

proxmox_ports:
  - 8006/tcp # proxmox web app
  - 2049/tcp # nfs

# 770 on this directory restricts access to authorized users, but
# won't affect permissions of container data within the directory
proxmox_nfs_mounts:
  - { path: "/hdd_mirror/media", owner: podman,
      group: podman, mode: "0770" }
  - { path: "/ssd_mirror/jellyfin", owner: podman,
      group: podman, mode: "0770" }
  - { path: "/ssd_mirror/proxy", owner: podman,
      group: podman, mode: "0770" }
  - { path: "/ssd_mirror/foundry", owner: podman,
      group: podman, mode: "0770" }

# 0 = Sunday, 1 = Monday, ..., 6 = Saturday
proxmox_cron_jobs:
  - { name: "Backup jellyfin config data, daily at 12AM",
      minute: "0",
      hour: "0",
      weekday: "*",
      job: "bash +x /root/backup.sh jellyfin /ssd_mirror/jellyfin"
  }
  - { name: "Backup proxy config data, daily at 1215AM",
      minute: "15",
      hour: "0",
      weekday: "*",
      job: "bash +x /root/backup.sh proxy /ssd_mirror/proxy"
  }
  - { name: "Backup foundry config data, daily at 1230AM",
      minute: "30",
      hour: "0",
      weekday: "*",
      job: "bash +x /root/backup.sh foundry /ssd_mirror/foundry"
  }
  - { name: "Backup media, Monday at 3AM",
      minute: "0",
      hour: "3",
      weekday: "1",
      job: "bash +x /root/backup.sh media /hdd_mirror/media"
  }
  - { name: "Trim ssd_mirror pool, Wednesday at 3AM",
      minute: "0",
      hour: "3",
      weekday: "3",
      job: "/usr/sbin/zpool trim ssd_mirror"
  }

proxmox_pbs_repository: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  34376661616131616461383662643439653835303561376432353261373165306230393238333634
  3166616465383030613637386234666235313134333466320a383866373235666437323630333432
  65336133343265346337313966343735373337373738656135303938376131623765366563646133
  6138373839326639630a353636633437656338333032303763613265343432633833366532396161
  63316664326437323466333136666564323630363133626232323462303734376433
proxmox_pbs_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  35613132396665333931366239316161376466313866613131393263383533323865303730383639
  3664623238306534353163633565613932613564633239650a376533343866333930666333353135
  62346138653065666665373639616266633666393566323136326331313437316335376431656564
  3535623236353562380a313064663435326338323462663566303732396165663034343639383132
  66313830636538613961353733616162653739626465366437363137663435383465
